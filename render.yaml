# Render Blueprint for Stabiliq Member Dashboard API
# https://render.com/docs/blueprint-spec

previews:
  generation: automatic

services:
  - type: web
    runtime: node
    name: stabiliq-api
    repo:  https://github.com/Sachin3348/stabiliq-backend.git
    region: frankfurt

    buildCommand: npm ci && npm run build
    startCommand: npm start

    envVars:
      - key: NODE_ENV
        value: development
      - key: PORT
        value: 8000
      # MongoDB (use MongoDB Atlas or external; set in Render dashboard or link below)
      - key: MONGO_URL
        sync: false
      - key: DB_NAME
        sync: false
      # Auth
      - key: JWT_SECRET
        generateValue: true
      # Optional: CORS allowed origins (comma-separated)
      - key: CORS_ORIGINS
        sync: false

    # Optional: custom domain
    # domains:
    #   - api.stabiliq.example.com

    # Optional: scaling
    scaling:
      minInstances: 1
      maxInstances: 3
      targetMemoryPercent: 80
      targetCPUPercent: 80

    # Optional: health check
    healthCheckPath: /api

    # Optional: restrict deploys
    # autoDeploy: false

    # Graceful shutdown (aligns with your SIGTERM handling)
    maxShutdownDelaySeconds: 30
